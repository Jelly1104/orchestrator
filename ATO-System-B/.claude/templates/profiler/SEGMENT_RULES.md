# SEGMENT_RULES.md

> **버전**: 1.1.0 | **수정일**: 2026-01-07
> **정의**: 세그먼트 정의 규칙
> **대상**: Analyzer | **로딩**: 작업 시
> **참조**: DOMAIN_SCHEMA.md (CODE_MASTER 테이블)

---

## 1. 활동 기반 세그먼트

### 활성도 세그먼트 (Activity Level)

| 세그먼트 | 정의 | 조건 |
|----------|------|------|
| **HEAVY** | 고활동 사용자 | 최근 3개월 로그인 10회 이상 + 게시글 조회 20회 이상 |
| **MEDIUM** | 중활동 사용자 | 최근 3개월 로그인 3-9회 |
| **LIGHT** | 저활동 사용자 | 최근 3개월 로그인 1-2회 |
| **DORMANT** | 휴면 사용자 | 최근 30일 방문 0회 |
| **CHURNED** | 이탈 사용자 | 최근 90일 방문 0회 |

### SQL 조건 예시
```sql
-- USERS 테이블 기준 (USER_LOGIN 대용량 주의: 반드시 인덱스 활용)
CASE
  WHEN login_count >= 10 AND view_count >= 20 THEN 'HEAVY'
  WHEN login_count >= 3 THEN 'MEDIUM'
  WHEN login_count >= 1 THEN 'LIGHT'
  WHEN DATEDIFF(NOW(), last_login_date) <= 30 THEN 'DORMANT'
  ELSE 'CHURNED'
END AS activity_segment
```

---

## 2. 라이프사이클 세그먼트

### 회원 생애주기 (Lifecycle Stage)

| 세그먼트 | 정의 | 조건 |
|----------|------|------|
| **NEW** | 신규 회원 | 가입 30일 이내 |
| **GROWING** | 성장 회원 | 가입 31-90일, 활동 증가 추세 |
| **MATURE** | 성숙 회원 | 가입 91일 이상, 안정적 활동 |
| **AT_RISK** | 이탈 위험 | 활동 감소 추세 (전월 대비 50% 이하) |
| **REACTIVATED** | 재활성화 | 휴면 후 복귀 |

---

## 3. 직업 기반 세그먼트

> **⚠️ 주의**: CODE_MASTER 테이블 참조 필수 (DOMAIN_SCHEMA.md)

### 전문과목별 (Specialty) - CODE_TYPE: 'MAJOR'

| 코드 | 세그먼트명 | 활성도 특성 |
|------|----------|------------|
| IM | 내과 | 절대 인원 최다, +6.4%p 과대 대표 |
| GS | 외과 | 일반외과 |
| OS | 정형외과 | +16.4%p 과대 대표, 개원 비율 높음 |
| DM | 피부과 | +16.5%p 과대 대표, 개원 비율 높음 |
| PS | 성형외과 | **+33.2%p 최고 활성도**, 개원 관심 극대 |
| PD | 소아청소년과 | +13.5%p 과대 대표 |
| OG | 산부인과 | 산부인과 전문의 |
| PSY | 정신건강의학과 | 정신건강의학과 전문의 |
| FM | 가정의학과 | 가정의학과 전문의 |

### 근무형태별 (Work Type) - CODE_TYPE: 'WORK_TYPE'

| 코드 | 세그먼트명 | 활성도 특성 |
|------|----------|------------|
| OWN | 개원의 | +12.3%p 과대 대표, 경영 정보 니즈 |
| EMP | 봉직의 | -9.4%p, 다른 접근 필요 |
| RES | 전공의 | -9.6%p, 다른 접근 필요 |
| PRE | 개원준비 | **+36.8%p 최고 활성도**, 정보 탐색 극대 |
| PUB | 공보의 | 공중보건의 |
| PRF | 교수 | 대학병원 교수 |

---

## 4. 행동 기반 세그먼트

### 서비스 이용 패턴

| 세그먼트 | 정의 | 주요 행동 |
|----------|------|----------|
| **JOB_SEEKER** | 구직 활동형 | 채용공고 조회 5회 이상/월 |
| **CONTENT_CONSUMER** | 콘텐츠 소비형 | 게시글 조회 20회 이상/월 |
| **COMMUNITY_ACTIVE** | 커뮤니티 활동형 | 게시글/댓글 작성 3회 이상/월 |
| **BROWSER** | 단순 방문형 | 로그인만 하고 활동 없음 |

---

## 5. 가치 기반 세그먼트

### 회원 가치 (Value Tier)

| 세그먼트 | 정의 | 기준 |
|----------|------|------|
| **VIP** | 최고가치 | 유료 서비스 이용 + 고활동 |
| **HIGH_VALUE** | 고가치 | 유료 서비스 이용 또는 고활동 |
| **STANDARD** | 일반 | 기본 활동 수준 |
| **LOW_VALUE** | 저가치 | 저활동 + 무료만 이용 |

---

## 6. 세그먼트 조합 규칙

### 복합 세그먼트 생성
여러 기준을 조합하여 세그먼트 생성 가능:

```
[활동] + [직업] + [행동]
예: HEAVY + 내과 + JOB_SEEKER = "적극적 구직 내과의"
```

### 우선순위
1. 활동 기반 (가장 최신 상태 반영)
2. 라이프사이클 (장기 추세 반영)
3. 직업 기반 (고정 속성)
4. 행동 기반 (특정 패턴 식별)

---

## 7. 세그먼트 분석 시 주의사항

### 최소 표본 크기
- 통계적 유의성을 위해 세그먼트당 최소 30명 이상
- 30명 미만 시 상위 세그먼트와 병합 또는 제외

### 중복 처리
- 한 회원이 여러 세그먼트에 속할 수 있음
- 분석 목적에 따라 primary segment 지정

### 시간 기준
- 활동 세그먼트: 최근 3개월 기준 (분석 보고서 기준)
- 라이프사이클: 전체 기간 고려
- 정기적 재분류 (월 1회)

### 스키마 준수 필수
- **컬럼명**: USER_DETAIL.U_MAJOR_CODE_1 (NOT MAJOR_CODE)
- **컬럼명**: USER_DETAIL.U_WORK_TYPE_1 (NOT WORK_TYPE_CODE)
- **JOIN**: CODE_MASTER 테이블로 코드명 조회
- **대용량 테이블**: USER_LOGIN(2,267만), COMMENT(1,826만) 조회 시 인덱스 필수

---

## 8. 우선 타겟 세그먼트 (Case4 분석 결과)

> **분석 기준**: 전체 대비 +5%p 이상 활성도 차이

### 1순위: 개원준비 + 성형외과
- **활성도 차이**: +36.8%p (근무형태) + +33.2%p (전문과목)
- **예상 전환율**: 35-45%
- **트리거**: 개원 관련 게시글 연속 3회 조회

### 2순위: 피부과 + 임대매물 조회
- **활성도 차이**: +16.5%p
- **예상 전환율**: 25-30%
- **트리거**: 임대매물/상권분석 페이지 방문

### 3순위: 내과 + 커뮤니티 활성
- **활성도 차이**: +6.4%p (절대 인원 최다)
- **예상 전환율**: 20-25%
- **트리거**: 내과 게시글 댓글 작성

---

**END OF SEGMENT RULES**
