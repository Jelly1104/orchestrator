SELECT U_ID, COUNT(LOGIN_DATE) AS login_count FROM USER_LOGIN WHERE LOGIN_DATE >= DATE_SUB(CURDATE(), INTERVAL 30 DAY) GROUP BY U_ID LIMIT 1000